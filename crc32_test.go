package crtf

import "testing"

// Test CRC32 computation.
func TestCRC32(t *testing.T) {
	data := []byte{
		0x03, 0x00, 0x0a, 0x00, 0x72, 0x63, 0x70, 0x67, 0x31, 0x32, 0x35, 0x42,
		0x32, 0x0a, 0xf3, 0x20, 0x68, 0x65, 0x6c, 0x09, 0x00, 0x20, 0x62, 0x77,
		0x05, 0xb0, 0x6c, 0x64, 0x7d, 0x0a, 0x80, 0x0f, 0xa0,
	}
	expected := uint32(0xa7c7c5f1)

	result := crc32(data)
	if result != expected {
		t.Errorf("CRC32 result mismatch.\nGot: 0x%x\nWant: 0x%x", result, expected)
	}

	// Test empty crc32
	result = crc32([]byte{})
	if result != 0x00000000 {
		t.Errorf("Empty CRC32 result mismatch.\nGot: 0x%x\nWant: 0x00000000", result)
	}
}
